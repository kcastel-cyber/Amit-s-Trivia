<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>הרפתקת הפתגמים הגדולה</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&family=Lexend:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1" rel="stylesheet" />

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#eebd2b",
                        "primary-hover": "#d4a720",
                        "background-light": "#f8f7f6",
                        "background-dark": "#221d10",
                        "secondary-accent": "#8EC5FC",
                        "tertiary-accent": "#E0C3FC",
                    },
                    fontFamily: {
                        "display": ["Lexend", "Assistant", "sans-serif"],
                        "body": ["Assistant", "sans-serif"]
                    },
                    boxShadow: {
                        'game': '0 8px 0px 0px rgba(0,0,0,0.1)',
                        'game-active': '0 4px 0px 0px rgba(0,0,0,0.1)',
                    }
                },
            },
        }
    </script>
    
    <style>
        body {
            font-family: 'Assistant', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .bg-pattern {
            background-image: radial-gradient(circle at 1px 1px, rgba(0, 0, 0, 0.05) 1px, transparent 0);
            background-size: 24px 24px;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .floating {
            animation: float 4s ease-in-out infinite;
        }
        @keyframes trumpet-blast-left {
            0% { transform: rotate(-30deg) scale(1); }
            50% { transform: rotate(-45deg) scale(1.2); }
            100% { transform: rotate(-30deg) scale(1); }
        }
        @keyframes trumpet-blast-right {
            0% { transform: rotate(30deg) scale(1); }
            50% { transform: rotate(45deg) scale(1.2); }
            100% { transform: rotate(30deg) scale(1); }
        }
        .trumpet-left {
            animation: trumpet-blast-left 0.6s ease-in-out infinite;
        }
        .trumpet-right {
            animation: trumpet-blast-right 0.6s ease-in-out infinite;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark overflow-x-hidden text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        // --- שירותים (Services) ---

        // Confetti
        const triggerConfetti = () => {
            if (typeof window.confetti === 'function') {
                window.confetti({
                    particleCount: 150,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#eebd2b', '#8EC5FC', '#E0C3FC', '#ffffff']
                });
            }
        };

        // Audio Service
        class AudioService {
            constructor() {
                this.ctx = null;
            }
            init() {
                if (!this.ctx) {
                    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
            }
            playCorrect() {
                this.init();
                if (!this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(523.25, this.ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(880, this.ctx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + 0.3);
            }
            playIncorrect() {
                this.init();
                if (!this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, this.ctx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, this.ctx.currentTime + 0.2);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.linearRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + 0.3);
            }
        }
        const audioService = new AudioService();

        // --- שאלות (Data) ---
        const TRIVIA_QUESTIONS = [
            {
                id: 1,
                text: "איזה פתגם מסתתר בתמונה של כוס המים?",
                options: ["מים שקטים חודרים עמוק", "לראות את חצי הכוס המלאה", "כל עכבה לטובה", "בור סוד שאינו מאבד טיפה"],
                correctAnswer: 1,
                explanation: "לראות את חצי הכוס המלאה פירושו להסתכל על הצד החיובי של הדברים.",
                category: "פתגמים בתמונות"
            },
            {
                id: 2,
                text: "גיל הפסיד במשחק כדורגל והיה עצוב. אמיר אמר לו: 'זה הכל בגללך!'. מה אמיר עשה לגיל?",
                options: ["הוסיף שמן למדורה", "זרה מלח על הפצעים", "הכה על חטא", "נתן לו כתף קרה"],
                correctAnswer: 1,
                explanation: "לזרות מלח על הפצעים זה להכאיב למישהו שכבר כואב לו.",
                category: "סיפורים"
            },
            {
                id: 3,
                text: "סבתא של מאיה רצתה לאפות עוגה. בפעם הראשונה היא נשרפה, אבל בפעם השנייה היא כבר ידעה לכוון את התנור נכון.",
                options: ["אין חכם כבעל ניסיון", "סוף מעשה במחשבה תחילה", "עדיף מאוחר מאשר לעולם לא", "החיפזון מהשטן"],
                correctAnswer: 0,
                explanation: "מי שכבר עשה או חווה משהו - יודע עליו יותר. לומדים מהניסיון.",
                category: "סיפורים"
            },
            {
                id: 4,
                text: "מהו הפירוש של הפתגם 'אין עשן בלי אש'?",
                options: ["שצריך להיזהר משריפות", "שכל שמועה או דבר רע כנראה מבוססים על קצת אמת", "שתמיד צריך לבדוק את התנור", "שהאש תמיד גורמת לעשן"],
                correctAnswer: 1,
                explanation: "אם שומעים שמועה, כנראה שיש בה לפחות קצת אמת. העשן מסמל את השמועה והאש את האמת.",
                category: "הסברים"
            },
            {
                id: 5,
                text: "נייה ארזה מטריה בתיק למרות שהיה שמש, ובצהריים התחיל גשם. איך אפשר לתאר את נייה?",
                options: ["היא קפצה מעל הפופיק", "היא רואה את הנולד", "היא הולכת בין הטיפות", "היא בנתה ארמונות בחול"],
                correctAnswer: 1,
                explanation: "רואה את הנולד הוא אדם שמבין מה עלול לקרות בעתיד ויודע לחשוב קדימה.",
                category: "דוגמאות"
            },
            {
                id: 6,
                text: "מה פירוש הביטוי 'פגע בציפור נפשו'?",
                options: ["פגע במישהו במקום הכי חשוב ורגיש לו", "עזר לציפור פצועה", "הצליח במשימה קשה מאוד", "נבהל מאוד ממשהו"],
                correctAnswer: 0,
                explanation: "לפגוע בציפור נפשו של מישהו זה לפגוע בו במקום הכי רגיש וכואב בלב.",
                category: "הסברים"
            }
        ];

        // --- רכיבים (Components) ---

        const { useState } = React;

        // Welcome Screen
        const WelcomeScreen = ({ onStart }) => {
            return (
                <div className="relative flex min-h-screen w-full flex-col items-center justify-center p-6 bg-pattern">
                    <div className="floating relative w-56 h-56 md:w-72 md:h-72 mb-6">
                        <div className="absolute inset-0 bg-white/30 rounded-full blur-xl"></div>
                        <div className="relative z-10 flex items-center justify-center w-full h-full">
                            <h1 className="text-3xl md:text-5xl font-display font-bold text-slate-900">הרפתקת הפתגמים</h1>
                        </div>
                    </div>
                    <p className="mb-6 text-center max-w-xl">התכונני לחידון קצר על פתגם ומשמעותו. לכל שאלה יש תשובות — בחרי את התשובה הנכונה. בהצלחה!</p>
                    <button
                        onClick={onStart}
                        className="px-6 py-3 rounded-full bg-primary text-white font-semibold shadow-game hover:bg-primary-hover active:shadow-game-active"
                    >
                        התחל את המשחק
                    </button>
                </div>
            );
        };

        // Question Card
        const QuestionCard = ({ question, onAnswer }) => {
            const [selected, setSelected] = useState(null);
            const [submitted, setSubmitted] = useState(false);

            const handleSelect = (idx) => {
                if (submitted) return;
                setSelected(idx);
            };

            const handleSubmit = () => {
                if (selected === null) return;
                const isCorrect = selected === question.correctAnswer;
                setSubmitted(true);
                onAnswer(isCorrect);
            };

            return (
                <div className="max-w-2xl w-full mx-auto p-6 bg-white/80 dark:bg-slate-800 rounded-xl shadow-lg animate-fadeIn">
                    <div className="mb-4">
                        <div className="text-sm text-slate-600 mb-1">קטגוריה: {question.category}</div>
                        <div className="text-xl md:text-2xl font-semibold">{question.text}</div>
                    </div>
                    <div className="grid gap-3">
                        {question.options.map((opt, i) => {
                            const isChosen = selected === i;
                            const isCorrect = submitted && i === question.correctAnswer;
                            const wrongChosen = submitted && isChosen && !isCorrect;
                            const baseClass = "text-right p-3 rounded-md border transition";
                            const className = [
                                baseClass,
                                isChosen ? "border-primary bg-primary/10" : "border-slate-200 bg-white",
                                isCorrect ? "border-green-500 bg-green-50" : "",
                                wrongChosen ? "border-red-500 bg-red-50" : ""
                            ].join(" ");
                            return (
                                <button
                                    key={i}
                                    onClick={() => handleSelect(i)}
                                    className={className}
                                >
                                    {opt}
                                </button>
                            );
                        })}
                    </div>

                    <div className="mt-4 flex items-center justify-between">
                        <div>
                            {!submitted ? (
                                <button
                                    onClick={handleSubmit}
                                    className="px-4 py-2 bg-primary text-white rounded-full"
                                >
                                    אשר תשובה
                                </button>
                            ) : (
                                <div className="text-sm text-slate-700">
                                    {selected === question.correctAnswer ? (
                                        <span className="text-green-600 font-semibold">נכון! </span>
                                    ) : (
                                        <span className="text-red-600 font-semibold">לא נכון. </span>
                                    )}
                                    <span className="block mt-1 text-sm">{question.explanation}</span>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // Main App
        const App = () => {
            const [started, setStarted] = useState(false);
            const [index, setIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [finished, setFinished] = useState(false);

            const startGame = () => {
                setStarted(true);
                setIndex(0);
                setScore(0);
                setFinished(false);
            };

            const handleAnswer = (isCorrect) => {
                if (isCorrect) {
                    setScore((s) => s + 1);
                    audioService.playCorrect();
                    // small delay then confetti for correct answers
                    setTimeout(() => triggerConfetti(), 150);
                } else {
                    audioService.playIncorrect();
                }
                // advance to next question after a short pause to allow user to read feedback
                setTimeout(() => {
                    if (index + 1 < TRIVIA_QUESTIONS.length) {
                        setIndex((i) => i + 1);
                    } else {
                        setFinished(true);
                    }
                }, 1200);
            };

            if (!started) {
                return <WelcomeScreen onStart={startGame} />;
            }

            if (finished) {
                return (
                    <div className="min-h-screen flex items-center justify-center p-6 bg-pattern">
                        <div className="max-w-xl w-full text-center bg-white/90 dark:bg-slate-800 p-6 rounded-xl shadow-lg">
                            <h2 className="text-2xl font-bold mb-4">תוצאות סופיות</h2>
                            <p className="mb-4 text-lg">ניקודך: <span className="font-semibold">{score}</span> מתוך {TRIVIA_QUESTIONS.length}</p>
                            <button
                                onClick={() => { startGame(); triggerConfetti(); }}
                                className="px-5 py-3 bg-primary text-white rounded-full"
                            >
                                שחק שוב
                            </button>
                        </div>
                    </div>
                );
            }

            const currentQuestion = TRIVIA_QUESTIONS[index];

            return (
                <div className="min-h-screen p-6 bg-pattern">
                    <div className="max-w-3xl mx-auto">
                        <div className="flex items-center justify-between mb-4">
                            <div className="text-sm text-slate-600">שאלה {index + 1} מתוך {TRIVIA_QUESTIONS.length}</div>
                            <div className="text-sm text-slate-700">ניקוד: {score}</div>
                        </div>
                        <QuestionCard question={currentQuestion} onAnswer={handleAnswer} />
                    </div>
                </div>
            );
        };

        // Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>